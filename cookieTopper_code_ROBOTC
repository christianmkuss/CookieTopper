#pragma config(Sensor, in1,    sensor,         sensorLineFollower)
#pragma config(Sensor, dgtl1,  Start,          sensorTouch)
#pragma config(Sensor, dgtl2,  Estop,          sensorTouch)
#pragma config(Sensor, dgtl3,  cookieone,      sensorLEDtoVCC)
#pragma config(Sensor, dgtl7,  cookietwo,      sensorLEDtoVCC)
#pragma config(Sensor, dgtl11, cookiethree,    sensorLEDtoVCC)
#pragma config(Motor,  port2,           Conveyor,      tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port3,           Servo,         tmotorServoStandard, openLoop)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

task estop()																//codes the top button for an emergency stop
{
	untilTouch(Estop);
	stopAllTasks();
}
task main()
{
	int cookie = 0;														//create a variable "cookie" and set to 0
	startTask(estop);													//task estop runs in the backround
	untilBump(Start);													//start the program when the start button is pressed
	clearLCDLine(0);													//clear the first line of the LCD
	clearLCDLine(1);													//clear the second line of the LCD
	while (1==1)															//run program while true
	{
		displayLCDPos(0, 0);										//at the first line of the LCD display next line
		displayNextLCDString("Cookies Ready: ");//display "Cookies Ready: " on the LCD
		displayNextLCDNumber(cookie);						//display the number of the variable "cookie"
		setServo(Servo, 127);										//set the servo to full in
		startMotor(Conveyor, -25);							//start the motor spinning counterclockwise at 25
		untilLight(2000, sensor);								//stop motor when light sensor reads less than 2000
		wait(.735);															//wait 0.735 seconds
		startMotor(Conveyor, 50);								//start the motor in the reverse direction to stop drifting
		wait(.01);															//run the motor this way for 0.01 seconds
		stopMotor(Conveyor);										//stop the motor for the conveyor belt
		wait(1);																//wait one second to dispense whip cream
		setServo(Servo, -127);									//pull servo (and resulting attatchment) fully out
		wait(.5);																//dispense whip cream for half a second
		setServo(Servo, 127);										//set servo to fully in
		wait(0.5);															//wait 0.5 second before starting motor
		cookie = cookie + 1;										//add 1 to the variable "cookie" each time program runs
		if (cookie == 1)												//if the variable "cookie" is equal to 1 do task below
		{
			turnLEDOn(cookieone);									//turn LED in port 3 on to display number of cookies topped (1)
		}
		if (cookie == 2)												//if the variable "cookie" is equal to 2 do task below
		{
			turnLEDOn(cookietwo);									//turn LED in port 7 on to display number of cookies topped (2)
		}
		if (cookie == 3)												//if the variable "cookie" is equal to 3 do task below
		{
			turnLEDOn(cookiethree);								//turn LED in port 11 on to display number of cookies topped (3)
		}
		startMotor(Conveyor, -25);							//start motor at 25 counterclockwise
	}
}
